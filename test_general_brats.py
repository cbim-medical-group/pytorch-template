import argparse
import importlib

import h5py
import numpy as np
import os
import plotly.graph_objects as go
import torch
from datetime import datetime
from plotly.offline import plot
from tqdm import tqdm
from utils import MetricTracker

from utils.clean_noise import CleanNoise

from data_loader.general_data_loader import GeneralDataset
from parse_config import ConfigParser


SEED = 123
torch.manual_seed(SEED)
torch.backends.cudnn.deterministic = True
torch.backends.cudnn.benchmark = False
np.random.seed(SEED)

def main(config):
    logger = config.get_logger('test')

    # config['data_loader'] = config['test_data_loader']
    # setup data_loader instances
    my_transform = config.init_transform(training=False)
    data_loader = config.init_obj('test_data_loader', transforms=my_transform, training=True)

    # build model architecture
    model = config.init_obj('model')
    logger.info(model)

    # get function handles of loss and metrics
    criterion = config.init_ftn('loss')
    metric_fns = [getattr(importlib.import_module(f"metric.{met}"), met) for met in config['metric']]

    logger.info('Loading checkpoint: {} ...'.format(config.resume))
    assert config.resume is not None, "In the test script, -r must be assigned to reload well-trained model."
    checkpoint = torch.load(config.resume)
    state_dict = checkpoint['state_dict']
    if config['n_gpu'] > 1:
        model = torch.nn.DataParallel(model)
    model.load_state_dict(state_dict)

    # prepare model for testing
    device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
    model = model.to(device)
    model.eval()

    total_loss = 0.0
    total_metrics = torch.zeros(len(metric_fns))


    now = datetime.now()
    # save_dir = '{:s}/test_results'.format(str(config.save_dir))
    save_dir = os.path.join(config['trainer']['save_dir'], "test_results", config['name'], now.strftime("%Y%m%d%H%M%S"))
    os.makedirs(save_dir, exist_ok=True)
    print(f"Save test results at {save_dir}")

    dice_list = []
    sensitivity_list = []
    specificity_list = []
    hausdorff95_list = []
    id_list = []

    metrics = h5py.File(f'{save_dir}/metrics.h5','w')

    # clean_noise = CleanNoise(top_num=1)

    # test_metrics = MetricTracker('loss', *[m.__name__ for m in metric_fns], writer=self.writer)

    pred_list = {}

    with torch.no_grad():
        for i, (data, target, misc) in enumerate(tqdm(data_loader)):
            orig_data, target = data.to(device), target.to(device)
            output = model(orig_data)

            # output = output.cpu().numpy()
            # # Remove small objects
            # new_output = []
            # for i in range(output.shape[0]):
            #     output_i = output[i]
            #     mask = np.argmax(output_i, axis=0)
            #     clean_mask = clean_noise.clean_small_obj(mask)
            #     output_i[1][clean_mask==0] = (output_i[0].min()-1)
            #     new_output.append(output_i)
            # new_output = torch.tensor(np.stack(new_output, axis=0)).float().cuda()

            new_output = output

            loss = criterion[0](new_output, target, misc)
            if len(criterion) > 1:
                for idx in range(1, len(criterion)):
                    loss += criterion[idx](new_output, target, misc)

            batch_size = new_output.shape[0]
            total_loss += loss.item() * batch_size

            # test_metrics.update('loss', loss.item())
            # for met in metric_fns:
            #     test_metrics.update(met.__name__, met(output, target, misc))


            for i, metric in enumerate(metric_fns):
                misc['input'] = orig_data
                total_metrics[i] += metric(new_output, target, misc) * new_output.shape[0]

            for i in range(new_output.shape[0]):
                output_i = new_output[i]
                target_i = target[i]
                id = misc['img_path'][i].split("/")[1].split("-")[0]
                if id not in pred_list:
                    pred_list[id] = [[],[]]

                pred_list[id][0].append(target_i.cpu().numpy())
                pred_list[id][1].append(output_i.cpu().numpy())

                # if np.count_nonzero(target_i.cpu().numpy()) < 10:
                #     # print(np.count_nonzero(target_i.cpu().numpy()))
                #     continue

                # dice_list.append(metric_fns[0](output_i, target_i, misc))
                # sensitivity_list.append(metric_fns[1](output_i, target_i, misc))
                # specificity_list.append(metric_fns[2](output_i, target_i, misc))
                # hausdorff95_list.append(metric_fns[3](output_i, target_i, misc))
                # file_id = misc['img_path'][i].split("/")[1]
                # id_list.append(file_id)
            # print(metric_fns[0](new_output, target, misc))
            # print(np.average(dice_list))

    n_samples = len(data_loader.sampler)
    log = {'loss': total_loss / n_samples}
    log.update({
        met.__name__: total_metrics[i].item() / n_samples for i, met in enumerate(metric_fns)
    })
    logger.info(log)

    for key in pred_list:
        case_result = pred_list[key]
        target = np.stack(case_result[0])
        output = np.stack((case_result[1]))
        dice_list.append(metric_fns[0](torch.tensor(output).cuda(), torch.tensor(target).cuda(), misc))
        sensitivity_list.append(metric_fns[1](torch.tensor(output).cuda(), torch.tensor(target).cuda(), misc))
        specificity_list.append(metric_fns[2](torch.tensor(output).cuda(), torch.tensor(target).cuda(),  misc))
        hausdorff95_list.append(metric_fns[3](torch.tensor(output).cuda(), torch.tensor(target).cuda(), misc))



    metrics.create_dataset(f"dice", data=np.array(dice_list), compression='gzip')
    metrics.create_dataset(f"sensitivity", data=np.array(sensitivity_list), compression='gzip')
    metrics.create_dataset(f"specificity", data=np.array(specificity_list), compression='gzip')
    metrics.create_dataset(f"hausdorff", data=np.array(hausdorff95_list), compression='gzip')
    # metrics['dice'].attrs["id_list"] = id_list
    print(f"3d dice avg:{np.mean(dice_list)}, std: {np.std(dice_list)},{dice_list}")
    print(f"3d sensitivity avg:{np.mean(sensitivity_list)}, std: {np.std(sensitivity_list)},{sensitivity_list}")
    print(f"3d specificity avg:{np.mean(specificity_list)}, std: {np.std(specificity_list)},{specificity_list}")
    print(f"3d hausdorff95 avg:{np.mean(hausdorff95_list)}, std: {np.std(hausdorff95_list)},{hausdorff95_list}")
    print(f"save at:{save_dir}/metrics.h5")
    # print(f"dice std:{np.mean(dice_list)},{np.std(dice_list)}, sensitivity std:{np.mean(sensitivity_list)},{np.std(sensitivity_list)}, specificity std:{np.mean(specificity_list)},{np.std(specificity_list)}, hausdorff std:{np.mean(hausdorff95_list)},{np.std(hausdorff95_list)}")
    # metrics.create_dataset(f"id_list", data=np.array(id_list))

    metrics.close()


if __name__ == '__main__':
    args = argparse.ArgumentParser(description='PyTorch Template')
    args.add_argument('-c', '--config', default=None, type=str,
                      help='config file path (default: None)')
    args.add_argument('-r', '--resume', default=None, type=str,
                      help='path to latest checkpoint (default: None)')
    args.add_argument('-d', '--device', default=None, type=str,
                      help='indices of GPUs to enable (default: all)')

    config = ConfigParser.from_args(args)
    main(config)

#python test_general_brats.py -c config_files/config_BRATS_seg_exp1_histnorm.json -r saved/models/brats_seg_AsynDGANv2_exp1/1006_175729/checkpoint-epoch15.pth


# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp1/1006_175729/checkpoint-epoch15.pth ...
# Save test results at saved/test_results/brats_seg_AsynDGANv2_exp1/20201007153347
# {'loss': 0.25375720443743055, 'dice': 0.8487795651614011, 'sensitivity': 0.8259200434981685, 'specificity': 0.9962976476648352, 'hausdorff95': 13.69883527930403}
# save at:saved/test_results/brats_seg_AsynDGANv2_exp1/20201007153347/metrics.h5
# dice std:0.035784174933255745, sensitivity std:0.05968105867278165, specificity std:0.001003148295093025, hausdordd std:4.101768033350936

#     val_loss       : 0.9949499411630804
#     val_dice       : 0.8462186641408895
#     val_sensitivity: 0.821838926536415
#     val_specificity: 0.9963073654860342
#     val_hausdorff95: 13.494535079905301



# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp2_histnorm_channelnorm/1007_113626/checkpoint-epoch4.pth ...
# Save test results at saved/test_results/brats_seg_AsynDGANv2_exp2_histnorm_channelnorm/20201007174811
# {'loss': 0.2523130500491286, 'accuracy': 0.9899026835794414, 'dice': 0.8127309945913461, 'sensitivity': 0.8494150462168041, 'specificity': 0.9936233688186813, 'hausdorff95': 17.155218349358975}
# save at:saved/test_results/brats_seg_AsynDGANv2_exp2_histnorm_channelnorm/20201007174811/metrics.h5
# dice std:0.0019223689652722636, sensitivity std:0.03683849609405132, specificity std:0.0451072621000645, hausdordd std:0.0015853996985996665

# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp2_histnorm_channelnorm/1007_213349/checkpoint-epoch18.pth ...
# Save test results at saved/test_results/brats_seg_AsynDGANv2_exp2_histnorm_channelnorm/20201008102326
# {'loss': 0.2967462754729903, 'dice': 0.826373805231227, 'sensitivity': 0.8971841553628663, 'specificity': 0.9926958133012821, 'hausdorff95': 14.336575663919414}
# save at:saved/test_results/brats_seg_AsynDGANv2_exp2_histnorm_channelnorm/20201008102326/metrics.h5
# dice std:0.030393611120611865, sensitivity std:0.03422614613577275, specificity std:0.00175842465489657, hausdordd std:3.871668036322198

# ===================

# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp13_nonorm/1007_231209/checkpoint-epoch28.pth ...
# Save test results at saved/test_results/brats_seg_AsynDGANv2_exp13_nonorm/20201010234316
# dice avg:0.7734367891571308, std: 0.18988324725919747,[0.23447647381470027, 0.8557775411183939, 0.8889396305894806, 0.8534080295062663, 0.7827208864769485, 0.8935648693866711, 0.8864946155943972, 0.8617606676834669, 0.918644308191613, 0.060320024076724994, 0.9216686599161108, 0.9113817834858894, 0.4675535200792602, 0.8922408146449574, 0.7731981169659323, 0.8431142511521417, 0.7652110532360189, 0.9180340612887757, 0.6492531411809435, 0.904271345702799, 0.7699728469680318, 0.8709843982028862, 0.8662880570225094, 0.387247764881143, 0.8620160580781874, 0.6599415018607621, 0.4258448309802429, 0.9022852776512139, 0.8936191421439258, 0.8302271902910117, 0.7576854200645968, 0.880537111732895, 0.8006178679322111, 0.9026041306208127, 0.8675335397094772, 0.7908500303565441, 0.8605595942451819, 0.627073568272296, 0.7394166539431871, 0.8263017799381066, 0.8738381691921684, 0.8068664164206137]
# sensitivity avg:0.7424329112536734, std: 0.2235034643782616,[0.17272199892263707, 0.7824917248370189, 0.8476763512581743, 0.8575311716324991, 0.9082955441640379, 0.9054815720590764, 0.8705278703644249, 0.9383765065190642, 0.926508494770246, 0.03137388747407388, 0.9682928830806474, 0.9077405023023087, 0.3143452476358391, 0.8950769715756843, 0.6672716484590415, 0.8825409229824586, 0.6463414634146342, 0.9307845345345346, 0.5467658049119071, 0.9528936814996065, 0.7062132546828915, 0.8120402815923226, 0.8139155863144556, 0.3552902985831671, 0.7818217011681864, 0.553066099237517, 0.2957734354824826, 0.9265553457489479, 0.9244222565977593, 0.7472186415023153, 0.6500212425242655, 0.8456038923188561, 0.7472954066250221, 0.8818307232455356, 0.8576977031469191, 0.8323494142606771, 0.8297250450327974, 0.4849197023110067, 0.6219886822958771, 0.7895631964538571, 0.8371589414858646, 0.934672639645648]
# specificity avg:0.9962062762096031, std: 0.0031310799047600335,[0.9877466906029241, 0.9981369774549881, 0.9974936492631861, 0.9957478179075931, 0.9909995763367971, 0.996795294443375, 0.9965294526099778, 0.9877138618709753, 0.9963055861107414, 0.999875479982302, 0.9937274900953998, 0.9973255626517195, 0.999714599891699, 0.9954382450812522, 0.9982368300556691, 0.9920191974223259, 0.9993752113469166, 0.9945190584633764, 0.9962841581154434, 0.9937174799705657, 0.9983372604427367, 0.9989835259845892, 0.9966032422322155, 0.9949129900752203, 0.9987004791863928, 0.9976482958218973, 0.9988837681078857, 0.9971273247145644, 0.9939490717134117, 0.9975622088680535, 0.9992944232093754, 0.9988073473753419, 0.9964261853963716, 0.9978619762267656, 0.9967434776933779, 0.9965536885241122, 0.9974409992229951, 0.9996667252101747, 0.9986448723930574, 0.9961150094971902, 0.9956461851338505, 0.9870523240965258]
# hausdorff95 avg:19.601467194702032, std: 13.955402815052762,[59.16528859693307, 16.32008206614018, 8.361477678411225, 14.229419645304052, 26.563826982277515, 11.907220716471366, 11.098442309568007, 16.79906110667347, 9.48750461461126, 73.99228029486379, 11.38112119452824, 12.42607411340532, 24.5923896065146, 18.393876643502363, 17.67200668201762, 13.614782037360316, 11.405523212972303, 9.633174319970863, 38.273989741738326, 11.299396759473078, 17.275987226755035, 9.663830958720116, 12.336661604586302, 53.91861429259118, 13.112102597315207, 19.1238461056772, 39.44778825105114, 9.517148977935907, 19.725918944325304, 19.543439353550635, 14.187287874757278, 7.981897425079276, 17.122154230786425, 10.009427587492231, 20.930488019163086, 22.2296676209678, 14.624243526498526, 6.348590070177108, 17.650940115136343, 16.546370586670484, 17.446819222930223, 27.90145926258151]

# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp2_histnorm_channelnorm/1007_213349/checkpoint-epoch18.pth ...
# Save test results at saved/test_results/brats_seg_AsynDGANv2_exp2_histnorm_channelnorm/20201010235615
# dice avg:0.7961252998890717, std: 0.10646356099328659,[0.9077686292510684, 0.8983361076064715, 0.5433564586620975, 0.9064842098913736, 0.6974094718391626, 0.576387396783177, 0.8591826079682268, 0.8258005376775309, 0.8560599391468942, 0.8327857963684514, 0.6391832571029595, 0.607585050180458, 0.8610419283249702, 0.8924926294437583, 0.9159821552317949, 0.8168500973117859, 0.8451433080108035, 0.8282751688706708, 0.895104573772331, 0.6472106101001118, 0.9055112802933917, 0.8274599825354706, 0.8816590418532119, 0.6601729001629957, 0.8261089916246108, 0.8375763323803013, 0.8382868906249452, 0.8318167359011854, 0.842168996956479, 0.8398749684226222, 0.6157279517520113, 0.7910962512835683, 0.8189683608727423, 0.8695181402994583, 0.6014145777952585, 0.8410885664676655, 0.8167074170424243, 0.8971094297375776, 0.7454503709455842, 0.5974262211235638, 0.8443825775596335, 0.8552966761622098]
# sensitivity avg:0.8703536047990712, std: 0.12406168004861604,[0.9177078420745142, 0.9775304514927987, 0.4364562586180481, 0.9332971767754377, 0.9281160384023939, 0.5563982349696636, 0.9301029192042533, 0.9547230623192565, 0.9860803180634099, 0.783995377452768, 0.8223295039709148, 0.6681457095827668, 0.9048513633296731, 0.9258979143205023, 0.9545789978599365, 0.9282044887780548, 0.8932607991201627, 0.9331539381513754, 0.9072215809658563, 0.5367429916541836, 0.9611176380446442, 0.8750153793736573, 0.9612949563736966, 0.883127264975485, 0.9552697945228665, 0.9082677934205621, 0.8004902690011577, 0.9218023691707902, 0.9744602802333273, 0.95304312777106, 0.7852743561030235, 0.8518644838562983, 0.9297070084900949, 0.9674178304634281, 0.8440397720925036, 0.9171605521821862, 0.89325029194239, 0.9149086669257676, 0.7942563672571009, 0.6809925580764098, 0.9699623408452388, 0.9333333333333333]
# specificity avg:0.9929957061949077, std: 0.004403142569201737,[0.9970981096542845, 0.9949887960065793, 0.9986611294518953, 0.9964378828751467, 0.9813414460606606, 0.9985665180014494, 0.9941625623606136, 0.9959024865164102, 0.9852456583352696, 0.9956842965850163, 0.9890133828527742, 0.994551425805064, 0.992474917937995, 0.9927388785592327, 0.9950883079838168, 0.9959770576947946, 0.9941346983009005, 0.9900068381283798, 0.9941978730115812, 0.9977299302479621, 0.9938082941787872, 0.9937996543107334, 0.9955736916463763, 0.994810494202079, 0.9821958819730512, 0.9946862843857146, 0.9964491803643707, 0.9945483700336856, 0.9864176888864524, 0.9955556369046114, 0.9941339819267286, 0.9951586230377315, 0.9960508874529455, 0.9910211549031395, 0.9816425958405988, 0.9938216413479839, 0.9900652257927129, 0.995104936475786, 0.9967002191750239, 0.9848488693221656, 0.9915657469411047, 0.9938584047145173]
# hausdorff95 avg:14.916177909653626, std: 7.455832668502178,[7.668612662552544, 10.415200616639988, 19.249126756847204, 5.318664236714689, 24.309462683622936, 6.597414033905644, 9.680199704686268, 6.110722014373502, 22.63386465723176, 14.722926790174535, 9.399827902023663, 44.94958764397731, 14.242332152401715, 7.843238232516493, 10.666393487889206, 29.49670390882404, 12.367046563852607, 13.118381706419152, 6.7877843962754945, 25.80417862718714, 11.654740342522294, 8.977508302110861, 18.279274994851697, 14.938562631981824, 20.81930013899203, 9.071949293570292, 11.117190980546164, 19.41103971335648, 16.60349591509234, 12.159983063332668, 16.276506302988007, 7.606723222831648, 11.03813506346552, 12.95664695983144, 15.987636902446836, 14.635761329053244, 22.643176909101676, 15.583553395435374, 21.067820467376464, 14.482602232714619, 21.07019853995523, 8.715996725779704]

# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp1/1006_175729/checkpoint-epoch15.pth ...
# Save test results at saved/test_results/brats_seg_AsynDGANv2_exp1/20201007153347
# 3d dice avg:0.8085003917675293, std: 0.1629325519683161,[0.17467258126507795, 0.8586126108193958, 0.8856865151073057, 0.8614948721420593, 0.8767115148756597, 0.8910858472031082, 0.9268276149640852, 0.8661561244191885, 0.8881280394446315, 0.4104437776377442, 0.9017422683386084, 0.9165098812408515, 0.3967212267390485, 0.9087254392099517, 0.7413319262870464, 0.8729335458566538, 0.8659281527180814, 0.9312520573299587, 0.7764307892245857, 0.9017139688225582, 0.8619697844626714, 0.8833985627983351, 0.8907576055435839, 0.7321628369943588, 0.8493585610540219, 0.620302653564166, 0.49418894305725547, 0.9038057950415782, 0.9211996193879566, 0.8938684237226286, 0.756813451937319, 0.8825757106108516, 0.8630514269725283, 0.9150238911340892, 0.8652817182482359, 0.8477022220627426, 0.892580160875679, 0.6083228872365437, 0.8262793423278757, 0.8774786390143968, 0.8824300574268765, 0.8353554071169403]
# 3d sensitivity avg:0.7858910344250626, std: 0.21481501669541048,[0.10279285625492064, 0.7826214371159675, 0.8763236777738262, 0.9038195114252144, 0.9097372831230284, 0.9303674124457861, 0.957901127189731, 0.9458514863787029, 0.9063685000400967, 0.26249048281656123, 0.982325667275301, 0.9219209989971208, 0.24901426510658758, 0.923383071507382, 0.6131461380056542, 0.9024895686515302, 0.8407812863940372, 0.955686936936937, 0.6786912990976771, 0.9757507937612773, 0.8809695880618005, 0.8318969599393882, 0.8958144068622673, 0.6084604199776823, 0.7585312135432197, 0.4923386634122936, 0.35565693954262434, 0.9274809631357449, 0.9671494867107299, 0.8626994785373895, 0.7192065100166672, 0.8566432318618179, 0.8418494360914602, 0.8909958357816212, 0.8938883189212956, 0.8371460197398763, 0.8620127111443429, 0.45162553858206034, 0.8015844785772029, 0.8377454903650804, 0.8366822813938198, 0.9755816733569065]
# 3d specificity avg:0.996489072691594, std: 0.0028271174665355737,[0.9969753612654996, 0.9983733397292461, 0.9956799393778709, 0.9945652946455836, 0.9963873034374785, 0.9958272641979874, 0.9959462948562667, 0.9877788515703136, 0.9945077734728051, 0.9997675380734691, 0.9907289940645031, 0.9971472554204885, 0.9999402018820702, 0.9955367815720608, 0.9987683219316232, 0.9937500692823823, 0.9985295817955502, 0.9945305128866504, 0.9981210130293385, 0.9923436477334052, 0.9978839472656651, 0.9990048740737216, 0.9939780961452134, 0.9994312303319915, 0.9988833731402871, 0.9981827921682429, 0.9989990628867822, 0.9971799857842975, 0.9944475912673505, 0.9968816009688971, 0.9980543185470656, 0.9986557373888185, 0.9967397020295488, 0.9983259245462165, 0.9953114286349395, 0.9982559990484087, 0.9981966166331964, 0.9998206664226178, 0.9968888301928962, 0.9977078802074619, 0.9967090701944079, 0.9877969849443349]
# 3d hausdorff95 avg:14.259702019192828, std: 9.109190045419563,[57.83429485147951, 13.908888441157426, 7.925123000445429, 8.212030559750936, 21.350477504410385, 8.511707038083468, 5.65409983953806, 12.438350865246885, 13.77604142395169, 24.893762838038587, 7.424979607650032, 7.754792321106877, 17.749764059207184, 7.9488176632295335, 15.172792390962377, 8.805437995860999, 9.766742482424124, 10.668596373572615, 18.280658170063102, 10.557923339553883, 6.403227446027278, 9.904884525642574, 16.893777918561003, 19.469678890805543, 14.021198180233693, 25.281815791231928, 36.27705374165476, 8.792059820519787, 8.67838955941138, 15.17684658249427, 17.64251327891753, 9.571986208347997, 14.510196554731829, 8.599010587244708, 17.70765578987306, 17.41826391151142, 9.795403098334834, 6.6667434544608115, 10.690159227472975, 12.12450682840744, 8.571036140157657, 16.075796504323197]
# save at:saved/test_results/brats_seg_AsynDGANv2_exp1/20201011232032/metrics.h5

#saved/models/brats_seg_AsynDGANv2_exp12_1/1007_173937/checkpoint-epoch80.pth

# saved/models/brats_seg_AsynDGANv2_exp12_0/1007_173902/checkpoint-epoch80.pth


# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp4/1012_162127/checkpoint-epoch47.pth
# 3d dice avg:0.7461610405265118, std: 0.15655832916120999,[0.8799487012810294, 0.871480873234133, 0.5315815346223998, 0.8923727520627748, 0.7642267088544611, 0.5244003275154271, 0.8174220923257021, 0.8181479731776119, 0.8543786076362555, 0.8293267844651234, 0.6238803504666206, 0.09442260056961527, 0.7655786968496149, 0.8758946901919374, 0.8753855840887655, 0.7402795948609395, 0.7738363034530267, 0.7974991806827918, 0.8670653203742946, 0.49038312595597056, 0.8716673057529517, 0.7759962201104947, 0.8611621431544524, 0.6564257973212676, 0.8505423784410804, 0.7804715328522863, 0.8221654559770183, 0.8045312180700619, 0.8701300159511286, 0.7487561140654818, 0.5728714189835233, 0.7750442014952829, 0.7835448789293246, 0.9007721821001536, 0.6017781319328954, 0.7854062450788273, 0.761075859206741, 0.8719382445916574, 0.5509237020124753, 0.4585060870957146, 0.7474001898613434, 0.8001425764608415]
# 3d sensitivity avg:0.796856076438735, std: 0.19753527861047343,[0.8548572152575897, 0.9657343286266751, 0.43469434656044126, 0.9359064750369098, 0.9421037737419473, 0.5682570325427468, 0.8334635308037103, 0.9217642773571161, 0.9641905719628806, 0.783915269798302, 0.8456963119763871, 0.05800472339511916, 0.646271679233379, 0.9194569496231819, 0.9195098835634985, 0.8392019950124688, 0.7245696554297554, 0.8642235110951427, 0.8736740193910846, 0.33887313392904916, 0.9818234806884069, 0.761719082726834, 0.872845286231113, 0.8426241739501172, 0.9163040717853213, 0.9761748362241909, 0.7689348385511632, 0.9309273709483794, 0.9304828913344158, 0.960182530388079, 0.7569055617767824, 0.8263266582043461, 0.9139753620775761, 0.939030298513025, 0.8165967605193878, 0.9541878141771292, 0.6787636607233271, 0.8472677808006218, 0.4610278447402439, 0.4456784817571083, 0.6828754121290839, 0.9689323278428259]
# 3d specificity avg:0.9934442106338119, std: 0.003935719271592709,[0.9975458814114534, 0.9936729797250226, 0.9984192884204585, 0.9954246425304778, 0.986703719068201, 0.9977055837134473, 0.9948879322380185, 0.9962002804880178, 0.9864073873918134, 0.9953424698332936, 0.9873414022844438, 0.9982499965132061, 0.9983937582568257, 0.9912280826134136, 0.9931391937877333, 0.995000448546999, 0.9960624730603659, 0.9905505095572317, 0.9931470196914751, 0.9991955544068852, 0.9896362760848484, 0.9947931379677805, 0.9968866615994401, 0.9952534539691849, 0.9881318822141791, 0.9892856664377031, 0.9966999528204585, 0.9929116472996434, 0.9916741322492489, 0.9915254988854951, 0.993213226270607, 0.9950899103920806, 0.9951442846641108, 0.9949185941126466, 0.9828645704192409, 0.988878863367027, 0.99645852376885, 0.9962280687309368, 0.9979161081144751, 0.9873892574873719, 0.9962902869094517, 0.98884823931654]
# 3d hausdorff95 avg:20.448157941371722, std: 12.597094128871609,[9.908512230042694, 20.934306037479395, 32.412620970879146, 16.725361781859565, 10.217943615370437, 14.527929885644443, 10.020024271267646, 12.297228077133344, 25.552882721537735, 15.325126779313887, 20.16625779244011, 77.80697843549991, 13.035373447920605, 9.89700220310418, 17.915985949778058, 31.694734992240118, 13.977391669030661, 14.09965770266002, 8.767766898126844, 32.6889292530312, 19.130122722317086, 8.943950496136368, 28.015375330573274, 5.739760488558309, 15.04783209235692, 34.38636000347893, 16.67589362621492, 36.79147224695167, 13.638539651200782, 20.783273594059626, 45.37113105912419, 12.392225396249184, 27.398460927407424, 14.717543794781808, 9.847954641734509, 16.033492288199504, 20.65714975643745, 12.667287826071007, 27.967119417825952, 16.461573397689317, 29.28981306072494, 18.89428700515917]

# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp6/1012_162214/checkpoint-epoch33.pth
# 3d dice avg:0.752050987582414, std: 0.15982383509455508,[0.8633321416589861, 0.89417667008074, 0.5598595712221943, 0.9052781872914473, 0.7378735083455201, 0.567290809191846, 0.9084786775664584, 0.8388030309687932, 0.8489642744583625, 0.7591347589467102, 0.677274252691706, 0.22461872507620867, 0.7280722449218998, 0.8861854553483901, 0.8813856215870703, 0.8671539906065189, 0.7004734565243559, 0.7876645873434982, 0.8756395519252281, 0.3961016413476436, 0.9137747380933138, 0.7966694499205829, 0.860194718175951, 0.6501926262334041, 0.849737941975993, 0.8380693818983732, 0.6214452480201289, 0.8528057302484466, 0.858626967421868, 0.854038761624159, 0.6306957618182764, 0.8709981336835081, 0.8165760479133672, 0.8583018442660587, 0.5444152509448883, 0.8198413033515264, 0.5711102857032422, 0.8780420941308621, 0.6229839897181377, 0.3744201540705194, 0.7446831006364515, 0.8507567915087506]
# 3d sensitivity avg:0.7625299086169384, std: 0.20146747620559624,[0.8076400571561305, 0.9386035914500704, 0.4520070476482304, 0.9207930338365121, 0.8724884723586304, 0.5347490347490348, 0.8655527830657332, 0.9405726395726175, 0.9289412864754243, 0.6487274379336129, 0.8271071226260398, 0.1628497817218922, 0.6194558297339151, 0.9061384146620276, 0.9103832804076508, 0.937780548628429, 0.5949212957962233, 0.8264555424387072, 0.8794503842376455, 0.25639681095831773, 0.9496119274779887, 0.767444941842307, 0.8167296233241115, 0.7600191856746962, 0.847490053331076, 0.9152449091909741, 0.45347919980344237, 0.9003601440576231, 0.8976186180768537, 0.967155298900241, 0.7733762597984323, 0.8757175605782165, 0.9047569502247378, 0.8923651225481062, 0.6911226629780018, 0.9308749605381383, 0.569057244564921, 0.8465137971239798, 0.5485798134367467, 0.33259441893430447, 0.6332001198920971, 0.9219289541575709]
# 3d specificity avg:0.9948714204753576, std: 0.0037416147700770164,[0.9982357714348673, 0.9959406140704352, 0.9987190265566782, 0.9967881935413561, 0.9874917486306215, 0.9986573650551526, 0.999007656326158, 0.9965377971899078, 0.9879574131846357, 0.9973604778192856, 0.9909988586939219, 0.9970545767656207, 0.9968609947845595, 0.9932318190592769, 0.9941187101125396, 0.9973707572987918, 0.9972427912737385, 0.9915191136632383, 0.9937432053201569, 0.9992886126412138, 0.9950720089875791, 0.9958861656544726, 0.9983410737367361, 0.9962154690347037, 0.9926689480566453, 0.9945150143696629, 0.999806534471524, 0.9960947733458845, 0.9922752258549113, 0.9958263383917053, 0.9947958532740998, 0.9978319242766418, 0.9963928833972304, 0.9934875290117301, 0.9838101482505851, 0.9920499630620404, 0.9856981776816278, 0.9967958863413334, 0.9979167929294226, 0.9887652454293523, 0.9982694505293762, 0.9939587504555977]
# 3d hausdorff95 avg:14.126554346882038, std: 10.207921035733763,[6.571562233946034, 8.391167889487491, 18.506550702379172, 7.292878908293806, 22.005880556832466, 6.393167555675898, 5.110201627702782, 5.824926007009274, 21.110267063566628, 11.414570668037364, 10.303706417982443, 42.4565286928877, 11.573395006667289, 6.734827528467066, 7.479588291869372, 16.413056279713416, 12.421142342095699, 10.117054655261683, 5.880775939974539, 36.84539057575056, 8.82367834844999, 7.985873776597736, 20.37246885839097, 12.638201255875073, 14.474345442552382, 8.109207707128082, 21.433355104690065, 14.355032957556078, 10.00778742677392, 10.04152055081922, 20.565214041427613, 4.583646768315963, 6.360145021000951, 13.24295862598232, 10.803046639984707, 14.560271600734428, 57.10302820589584, 10.073944902656795, 17.538487611145033, 15.391076397750352, 14.875862586915304, 7.129489794802126]

# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp8/1012_162306/checkpoint-epoch21.pth
# 3d dice avg:0.8306468883934887, std: 0.14074537590790018,[0.9290629075759168, 0.9087440979663944, 0.6324423749974194, 0.9392728066643103, 0.7947161058312915, 0.494154700501819, 0.8977481833833989, 0.8406286432979196, 0.925749179413288, 0.841917582765924, 0.906272786856196, 0.35099295655734, 0.753601625155557, 0.9007526478732922, 0.9328431917211797, 0.9006998471826214, 0.8404819224656342, 0.9094623485772031, 0.8781010387603253, 0.36257419632038085, 0.9361549379390162, 0.852813459649408, 0.9344749847288418, 0.8678225451568466, 0.9132623265766807, 0.8723546367179138, 0.673976310169412, 0.907236261260091, 0.9262419361768695, 0.8573229804801673, 0.8163558349044967, 0.901977623180299, 0.8977848307407097, 0.9175288090385827, 0.9240324830984994, 0.8503877086044147, 0.6419850331767357, 0.8842744736013634, 0.7757628280586637, 0.8236981395114, 0.8697492567013766, 0.9017527691873246]
# 3d sensitivity avg:0.7842297441581216, std: 0.18721089702619084,[0.8953369985746283, 0.961139303292762, 0.4683763423625581, 0.9248595429890115, 0.8569044245000788, 0.39943204073638855, 0.8412934624326188, 0.9434146532023361, 0.9265622368199428, 0.7353912715652657, 0.8875352807154759, 0.2177324132140327, 0.6089144619568372, 0.8663070736853601, 0.9338350777837646, 0.8488146849921594, 0.7325835049387456, 0.8475145823880263, 0.8034697048161574, 0.2217597229177099, 0.9487467142320691, 0.7594656159576433, 0.9118074723974764, 0.8080656230595771, 0.8957940520278543, 0.8657396928051738, 0.5101946948908924, 0.8766334823744473, 0.9540498122807377, 0.9236433831414885, 0.7689446454536233, 0.9116649042786572, 0.8846704155991082, 0.9010953107843925, 0.8776807638244883, 0.8319614977299179, 0.4780893187611299, 0.8768680277836245, 0.641961493213968, 0.7091082040614356, 0.7953360218898073, 0.8849513242097317]
# 3d specificity avg:0.9980901899522598, std: 0.0018948959322456823,[0.9990411812740994, 0.9959167804332866, 0.9998794977320506, 0.9985892852070366, 0.9898592782732655, 0.9988266611367739, 0.999023834564093, 0.9960934995802608, 0.9961439223898056, 0.9994663581744225, 0.9981556316184492, 0.9996780136759454, 0.9997107696736597, 0.9970190672803972, 0.9972176488034769, 0.9995451953386021, 0.9996798999150242, 0.9993345101448168, 0.9985352911162765, 0.9999714909552564, 0.9967323314314782, 0.9993088702772392, 0.9991343937099993, 0.9994185037776224, 0.9962755281903, 0.9973274779243001, 0.9998465243047286, 0.9987389434653254, 0.9949966153431965, 0.9963342362897752, 0.9987814127793866, 0.997877995410151, 0.9987480038450021, 0.9974381300132705, 0.9991824700417871, 0.9966108205815208, 0.9995721786820412, 0.9955178644766373, 0.9998435285143548, 0.9994899143385176, 0.9990960250533869, 0.9978283922578912]
# 3d hausdorff95 avg:13.581953277265464, std: 6.511317917939355,[9.349813209573096, 6.700495097034501, 22.41584253621206, 6.330569457492917, 15.799225970368532, 13.40761090822962, 9.605248102658116, 17.001548456003015, 8.657791725080747, 10.88455820912673, 11.350167082518585, 17.55086635485295, 13.519154482045131, 10.362139176835536, 8.184898532389358, 18.373210849313978, 10.738392655000164, 13.37259648624275, 13.495984007756176, 36.491688063696046, 9.380725027064283, 11.028119471363436, 20.011141737471217, 8.154136404295965, 8.56460551449339, 9.966010705633616, 16.811288384069208, 16.13142885981904, 7.7294137502063105, 14.204716972154076, 29.86291809750638, 8.877825944563993, 5.946336087536439, 11.873444192173265, 7.723295181323556, 12.613631075935295, 28.153394099181167, 11.602977915046493, 17.40590406738451, 21.617978315400325, 11.710314525364712, 7.480629954732769]
# save at:saved/test_results/brats_seg_AsynDGANv2_exp8/20201013152217/metrics.h5

# saved/models/brats_seg_AsynDGANv2_exp11/1013_004648/checkpoint-epoch33.pth
# 3d dice avg:0.8208790217599758, std: 0.17686543811865194,[0.9349591545083832, 0.9055504646094, 0.6291919222249533, 0.9358843677924729, 0.8492209812580912, 0.761274943334674, 0.9528785217993715, 0.8673144955725175, 0.8947757591240686, 0.9056601996694509, 0.8875965344223148, 0.20789050936719586, 0.4966692106739033, 0.8096573444523981, 0.9035491289094089, 0.8826384235859467, 0.8306844152254041, 0.9195544074178166, 0.913115716433452, 0.28086860298973254, 0.9047919468364554, 0.8882301725101653, 0.8924405061098196, 0.8972666975622405, 0.9015574725612656, 0.875457904891084, 0.3164335362926141, 0.8555841772773946, 0.9027287843668216, 0.916471326266654, 0.8233544557273267, 0.9172224880319856, 0.8988591090240617, 0.9441067957437765, 0.8907719847852298, 0.8686084009826213, 0.907729103408677, 0.9290568910346939, 0.6359402277587033, 0.8674536111724386, 0.7942073724040922, 0.8797108457999037]
# 3d sensitivity avg:0.8192464574043582, std: 0.22105283459434907,[0.8972484416155964, 0.9771489711305146, 0.4625100176310306, 0.9604186212028081, 0.9708565604197863, 0.6256365060712887, 0.96277112127328, 0.8498740160556283, 0.9772944981743413, 0.8649092942513351, 0.8422747510451007, 0.12402530914437239, 0.6646915012638296, 0.7035929427819475, 0.9764632427911879, 0.9436398856194078, 0.7467889427943178, 0.8617138653916881, 0.9010601577909271, 0.16418937947867446, 0.9848778887170112, 0.8243935849288925, 0.9681338722397477, 0.906532893231805, 0.977150900900901, 0.8597251414713015, 0.19290508550831542, 0.9571377442087206, 0.9883521736454465, 0.9464687198886549, 0.8237581577790553, 0.9355368248255832, 0.8841213855521911, 0.9693739325048589, 0.9584673488567576, 0.917725759510898, 0.9056643268814804, 0.9112854644031384, 0.47014432871366674, 0.7901111201856327, 0.826761621328668, 0.9326149097732493]
# 3d specificity avg:0.9956347069408549, std: 0.006536837413008025,[0.9993395721047986, 0.9952141615347422, 0.9999278194435091, 0.9970798340681805, 0.989306132995191, 0.9999026626010669, 0.9982812522478116, 0.9985741792915696, 0.9893704822132859, 0.9979183722462901, 0.998557116914982, 0.9990296280277613, 0.958742900470244, 0.9982066175710022, 0.9924600700161378, 0.9975399732481566, 0.9984623670222519, 0.9994882025436415, 0.9959970029680051, 0.9999051024763669, 0.9919547972301155, 0.9989811434026513, 0.99560422544904, 0.9987760188013607, 0.9892326300034617, 0.9976587313393305, 0.9989341770163688, 0.9936728699920786, 0.9904956028514402, 0.998109034045894, 0.9981204780390716, 0.9979829105496767, 0.9987920268937288, 0.9965812980887505, 0.992812851669598, 0.9946816120341139, 0.9966037116353756, 0.9978740665785346, 0.9998991170684656, 0.9987279799310813, 0.9931042154407309, 0.9947547434500466]
# 3d hausdorff95 avg:16.613252753840936, std: 12.09687805019397,[7.184978073127473, 7.420349581429865, 22.70724596321983, 6.175161922137362, 13.25430507676672, 5.413790612819086, 3.512922745441913, 5.521685484046244, 14.364958493461021, 10.962181867718646, 9.220841542280922, 62.312714886379005, 46.08846562700109, 19.560010198593616, 12.889590888339304, 23.966294448093514, 15.414238997735008, 9.224028372899678, 8.439506097175839, 35.435185835255254, 18.147373503774855, 13.737627089522402, 22.004530565095397, 6.997254073549247, 10.155958330723601, 8.627067639173884, 35.56654734813562, 25.18029733853862, 8.991534909812794, 12.143714940256539, 17.98818262374058, 8.004180537002656, 5.82616444888864, 14.085099394983544, 25.49377449808032, 19.115825324087556, 11.407566235714462, 8.135555155275819, 20.502904147917096, 12.391364732967245, 41.39025360282549, 12.795382507331505]

# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp8/1012_162306/checkpoint-epoch45.pth
# 3d dice avg:0.7729516684338437, std: 0.12153907532991659,[0.8912561310545049, 0.8334173909419924, 0.5858451658592644, 0.8885379762692618, 0.7234805277140965, 0.5637433415260343, 0.9230148355280902, 0.7849263158427034, 0.8652288587759234, 0.8265936164040024, 0.6361265652634678, 0.3512165094810512, 0.7670239225684228, 0.8090349416990825, 0.8812551185586419, 0.8737705313359134, 0.807118497023672, 0.8379635136850352, 0.8546795473888308, 0.6096477944944366, 0.8898073639050706, 0.8573729424333523, 0.8979127229243625, 0.6659764341292187, 0.8268435539634106, 0.804831062679787, 0.7856072981777992, 0.8255863477187748, 0.8528781007056941, 0.7387342400351942, 0.6401337780748165, 0.8016403420344794, 0.8011327426538648, 0.890576154971202, 0.5912178818626982, 0.8166707195411635, 0.7377376162645001, 0.8251135457978689, 0.6940475510467725, 0.5198096230706664, 0.867089589632983, 0.8193693611833296]
# 3d sensitivity avg:0.8219104279395233, std: 0.16128877736405936,[0.8824920636037926, 0.9577499975017737, 0.4898498544507431, 0.961288378679683, 0.9423534699449003, 0.5548814120242692, 0.9106870634276569, 0.9306607209872183, 0.9404528774566882, 0.7675503771781208, 0.88545362392296, 0.2859085378945108, 0.6652783721658718, 0.8060166190707786, 0.9336828890037664, 0.879501246882793, 0.7878276068619461, 0.9033601943574741, 0.863322177796603, 0.45253357590026216, 0.9637032037713082, 0.9118974834612582, 0.9023196424771228, 0.8570134299722874, 0.8861042918818252, 0.9494025955580805, 0.6714706909260193, 0.9307172869147659, 0.9016176559023393, 0.9559423333198724, 0.8037513997760358, 0.9351306291798496, 0.941901115365407, 0.957303817438726, 0.8091785284012315, 0.9377959639622138, 0.6410316328994617, 0.8197357170617956, 0.6491283233763058, 0.5216811056572191, 0.8371066040563493, 0.9354534629886883]
# 3d specificity avg:0.9936612424857546, std: 0.004057115055325816,[0.997274944209874, 0.9913992896074624, 0.998563729634995, 0.9942698452953738, 0.983165092087608, 0.9984154583656404, 0.998444882345948, 0.9949493940006533, 0.9891659911403703, 0.9960845639865926, 0.9868579717198571, 0.9964900831912312, 0.9973482096496856, 0.9909108716071234, 0.9929878182263628, 0.9984394059606654, 0.9956298724676744, 0.992121290995662, 0.9924048294190344, 0.9994033911058248, 0.9922579141039979, 0.994436295856596, 0.9978308619867823, 0.9953058132797173, 0.9871903662280092, 0.9916407196816768, 0.9987667360285749, 0.9940086740878554, 0.9914966894168574, 0.991139247910669, 0.9945784476667515, 0.9936152419492861, 0.9952535400680326, 0.9932945861353671, 0.9822764333630704, 0.9916093196090311, 0.9967329875195233, 0.9934392974919051, 0.9978298214310783, 0.9877143661192542, 0.9975928813738485, 0.991435008076171]
# 3d hausdorff95 avg:15.12901144825263, std: 5.932402385900854,[9.016950263794376, 16.333925803086917, 25.832470276732796, 13.160674696205085, 16.59223140095055, 10.55979746398231, 5.464378666743538, 14.81366431343544, 15.369341703882487, 13.653255559778298, 18.64401056186348, 34.82582849803243, 15.576977847757002, 10.516432531805, 10.891871092935437, 12.098765415331867, 13.386109923706169, 10.753201876708696, 11.469397512100134, 20.05877433383165, 13.483969722562195, 7.305664853558146, 18.589479875492152, 6.1619041780427715, 16.366828454650484, 14.54922993340549, 11.848279492977294, 16.49729669044357, 11.826148565982933, 20.50296863083917, 27.490150450259787, 12.619948531540334, 9.675573704161447, 12.825371986774423, 12.341103045180565, 18.636287336012565, 30.900776245510073, 16.092826124682265, 16.652930738385464, 14.058989079808255, 11.462300699068555, 16.512392744608864]

# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp2_histnorm_channelnorm/1013_113113/checkpoint-epoch6.pth
# 3d dice avg:0.8592643561864061, std: 0.12769499197705186,[0.9340167303435214, 0.915750453377526, 0.6245054090621808, 0.94196514771821, 0.858735704254742, 0.5947581991142726, 0.9587062400807131, 0.9007647835905043, 0.928128867530626, 0.8845098661637762, 0.9045648325197838, 0.48977109920998946, 0.8482321613692446, 0.9215439259442968, 0.941808339411371, 0.9054323498377682, 0.8241480531848637, 0.9301626508027615, 0.9176584325267326, 0.32562380545220554, 0.9426903047622485, 0.8955866339102309, 0.9325464152634043, 0.8742625287914134, 0.9288029814082631, 0.8916514057714512, 0.7660689057968507, 0.9270915399669138, 0.9406170127790285, 0.929830851979365, 0.8353019275312729, 0.9078610566668048, 0.8990811472752072, 0.948651818108605, 0.9292109501882773, 0.8782272594194585, 0.8642774092386912, 0.9314631810382222, 0.7663151286653526, 0.8183032975152335, 0.8254195230769045, 0.9050546291807771]
# 3d sensitivity avg:0.8232791195953336, std: 0.1780274204144284,[0.8947458306238135, 0.9696764470220154, 0.45789389325212376, 0.9466479031197093, 0.96286569044245, 0.42332549941245595, 0.9516707968219094, 0.9420669179834756, 0.9894286837187292, 0.8037987182018922, 0.8631193253307036, 0.32759570727611453, 0.7771757604901628, 0.9486312455879657, 0.9573937566634949, 0.8586615625864773, 0.7042947890125999, 0.8790598880756508, 0.9245887894256615, 0.21421715907194125, 0.965795155839279, 0.8229852859693406, 0.9345918769716088, 0.8063335403117748, 0.9346271437263842, 0.8935327405012126, 0.6221664706650987, 0.9083520664015217, 0.9749399913833782, 0.9114773241819785, 0.8082710580597167, 0.8928520698852607, 0.8693142115595781, 0.957462306847701, 0.9028363458207206, 0.8481613907791676, 0.859150109989874, 0.9119386844148963, 0.6317465782904365, 0.6957718601221217, 0.7374271849288295, 0.891131262234785]
# 3d specificity avg:0.9979163107150626, std: 0.0020701938771934343,[0.9993670735638492, 0.9960777042013987, 0.9999196651547004, 0.9979912201656238, 0.990534416823762, 0.9999989419847942, 0.9990026341512906, 0.9980587857744294, 0.9926839410717304, 0.9993670518673318, 0.9988265716047086, 0.9998574271082276, 0.9977469768504237, 0.9942604496739751, 0.9969156863981466, 0.9995192481495864, 0.9998543570808129, 0.9995471869189246, 0.9950058393332956, 0.998059989409787, 0.9965203745513579, 0.999524156324735, 0.9984773931594522, 0.9995895526965617, 0.9955999519778793, 0.9975161436152264, 0.9999132068481914, 0.9988445423222944, 0.9953721234048776, 0.9992219325788323, 0.9986530271922825, 0.9985684550812373, 0.9990626960779334, 0.9975181748557833, 0.9984984851523249, 0.9977341826657422, 0.9951253178638494, 0.998056018590297, 0.9997961753015936, 0.99980854849366, 0.9986698544263818, 0.9978195695653378]
# 3d hausdorff95 avg:10.694196423543259, std: 6.159019189088894,[6.542758537347542, 4.755726139554562, 21.355505733644712, 7.3348070295201575, 12.370913807341777, 7.387364528570041, 2.5068777079090085, 4.184929558024817, 7.044260825216042, 12.326391666387762, 18.676297997798848, 29.71225567773164, 11.937348217164251, 7.321733219478927, 4.319664572679499, 9.711805108463105, 13.594571542809378, 8.583447744299379, 7.741495346119144, 24.976775237978188, 6.3805240356657835, 11.455074766397475, 20.232447399066398, 8.286109664402623, 7.954114422555078, 20.097843237650196, 14.058792994147256, 5.584230660181342, 5.299834959787677, 4.284895391447495, 12.25198765582892, 5.032713495060947, 6.260237215957525, 6.213981173242249, 6.481508022196985, 11.812492699761595, 11.201007823303614, 7.429103550379192, 18.20948598783753, 14.442822978346197, 17.985631934272316, 5.816479523289651]

# saved/models/brats_seg_AsynDGANv2_exp14/1013_123640/checkpoint-epoch12.pth
# 3d dice avg:0.8471919977506107, std: 0.15329629445974105,[0.9306314375162081, 0.9160070356487682, 0.5816289579601155, 0.9354271288971333, 0.8874174110407145, 0.7597705225303542, 0.9497934476735538, 0.8873561910399824, 0.8941972098887361, 0.8598138832986206, 0.9028952913653565, 0.0062072935544081964, 0.6672287640490606, 0.9242722448157972, 0.9181622356051364, 0.8371908871998306, 0.8481933601545155, 0.9181940401833555, 0.9293016741652441, 0.6898589408828399, 0.9348495774749971, 0.8560785352384719, 0.894651091316213, 0.8715266976087697, 0.8997825530341408, 0.8716745032310287, 0.8232251340656629, 0.9216482454819508, 0.9354402421913093, 0.9154622681033702, 0.796835484934667, 0.9139427980449256, 0.8665788964725527, 0.9396020570056621, 0.9358532315797152, 0.8896958550643461, 0.8674550995408798, 0.9167395885334966, 0.731678250913283, 0.8688012575774441, 0.7903302001355329, 0.8966643805074996]
# 3d sensitivity avg:0.8318067207818441, std: 0.1866044929385323,[0.907390256238464, 0.9735873173337403, 0.41205321365603464, 0.9691641594685818, 0.9601322626358054, 0.622502937720329, 0.9471425286769026, 0.9197413910971346, 0.9894607666209485, 0.7669470226020143, 0.8772656170299589, 0.003253653800739944, 0.5347309162362266, 0.9441616842368009, 0.9650918845796697, 0.950903975648003, 0.7563348574220795, 0.880256728941848, 0.9220446680312036, 0.5931084126189284, 0.9764645137063462, 0.7808132734100843, 0.9574625394321766, 0.8251576848916631, 0.906877953140376, 0.8796443007275667, 0.7103724029792239, 0.9475803463353178, 0.9808587899800997, 0.9411953957246014, 0.7884556859297333, 0.9037736146841117, 0.8322796393038965, 0.9687153530971319, 0.9126524470262988, 0.9235406989546089, 0.8592618457348371, 0.9276449966976099, 0.5813893432039253, 0.7857873775540107, 0.7496114940556207, 0.9010683216727968]
# 3d specificity avg:0.9971291737087592, std: 0.0022173094846426322,[0.9987241287390444, 0.9959708427352898, 0.9999543963848112, 0.9967321178552617, 0.9931036526338611, 0.9999127137455219, 0.9985988798610465, 0.9980119087829491, 0.9885329506459084, 0.99921301306531, 0.9982892463511712, 0.9993670795140438, 0.9972242673704604, 0.9948481419110118, 0.9944128781244235, 0.9959449499773181, 0.9991874382458306, 0.9984808417262139, 0.9965605759963717, 0.9975845063908108, 0.9952935759794763, 0.9986140499365214, 0.9960088023019751, 0.9992660318929122, 0.9938504535163265, 0.9968888301928962, 0.999374030853907, 0.9975481004186618, 0.9945126433152786, 0.9981752466432138, 0.9979795407884238, 0.9985705898947079, 0.9987124467671844, 0.9962128783886103, 0.9985962592205174, 0.9958542182645225, 0.9953950485158876, 0.995949044874259, 0.9999066661313695, 0.9990686823083902, 0.9960298571185265, 0.9969637683876554]
# 3d hausdorff95 avg:15.349636301688014, std: 12.46755277814191,[5.9556944096055355, 6.102038767751004, 23.219589030343556, 6.186563895586222, 8.152750508325099, 5.139826000018386, 5.7439536474357915, 5.260297069776335, 16.81681261950577, 14.885763651809059, 16.80170994300077, 74.56229161047973, 27.60910214407772, 6.465370629349097, 12.162452836794392, 26.863658373759073, 14.48801282117994, 15.755693803854896, 6.413596190709209, 22.89141370910839, 16.416744761286843, 17.468261632269858, 23.29934931138526, 8.7663521881326, 10.335464614242138, 10.888976949526478, 20.59295759720006, 13.946357435350247, 4.832932072153899, 10.723376082628205, 42.146670168762846, 6.446749286942774, 7.254969987929288, 13.67876605394172, 5.5189564361951815, 12.12365687101677, 10.671551864349787, 12.371002621578308, 18.388609017159734, 13.062461020542179, 36.45076196837635, 7.823205067456059]

# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp15/1013_123732/checkpoint-epoch8.pth ...
# Save test results at saved/test_results/brats_seg_AsynDGANv2_exp15/20201013214512
# {'loss': 0.25162116143402163, 'dice': 0.8847489018143315, 'sensitivity': 0.8643294449690934, 'specificity': 0.9972944210737179, 'hausdorff95': 12.103103537087913}
# 3d dice avg:0.8531540152350601, std: 0.13981076529728845,[0.934423052415178, 0.9185376510853197, 0.5638158936887079, 0.9398781218199775, 0.8896558805812148, 0.7286888217301066, 0.9429777010149704, 0.888659546005308, 0.9115626834844777, 0.8657158639183776, 0.9141818620535039, 0.15301375575895193, 0.6595827891914181, 0.9335214218943154, 0.9227649051616438, 0.8673022184462118, 0.8554343549255924, 0.921206988386445, 0.9258475661285703, 0.6461914313785269, 0.9383065042904328, 0.8640088300672778, 0.9093513469917289, 0.8703446563608896, 0.9303722638871871, 0.8807777660089712, 0.8068792433680342, 0.9290330390181805, 0.9377370058285126, 0.9210617062942215, 0.8114984063835126, 0.9007040336977794, 0.9112926971435485, 0.9358913924784587, 0.9391601524619758, 0.887422009679704, 0.8701711758254478, 0.91544112440877, 0.6868626374139502, 0.853447719913445, 0.8559577744511593, 0.8937846448305138]
# 3d sensitivity avg:0.8335802637815578, std: 0.187418735843616,[0.9026937552958796, 0.9701438437178068, 0.39445423946145214, 0.9613244476076478, 0.9545835301527319, 0.5817665491578535, 0.9277584753340317, 0.941852061644237, 0.9859396681023765, 0.7841902590524747, 0.8937497874655694, 0.10054839810028601, 0.49638098712410766, 0.9446297011322109, 0.9675681252794369, 0.9241536758601605, 0.7595633660256187, 0.8727074250166045, 0.9271699012765817, 0.5022012184944082, 0.9737748779571911, 0.7891168503355291, 0.9504756506309149, 0.8091767704826955, 0.9650355691438616, 0.927194826192401, 0.678891937802169, 0.9472839109705787, 0.9804125720616294, 0.9547556063964158, 0.7970784161228147, 0.865200991145973, 0.9008085715236416, 0.9624059344955946, 0.9151954179862702, 0.9388178796489499, 0.8253849645588184, 0.9442440429963928, 0.5266419901867953, 0.7632414618093422, 0.8627310776153839, 0.9391223434605898]
# 3d specificity avg:0.9973523635320322, std: 0.0020579880745042875,[0.9991209355053462, 0.9962333227903424, 0.9999550004062044, 0.9973241936902513, 0.9935223365976045, 0.9999190618367567, 0.9988156162240702, 0.9976926384625968, 0.9909105566859862, 0.9987312012538717, 0.9984036787707797, 0.9969997063808922, 0.9996431924946082, 0.9958749776211592, 0.9947223136905972, 0.9973837070311634, 0.9995109436508594, 0.9990994888488721, 0.995824026305346, 0.9990035789816171, 0.9957426105551386, 0.9988003031227549, 0.9969464528421994, 0.9994609154972774, 0.9938173640691875, 0.9960010129896328, 0.9998433489455161, 0.9979245227293877, 0.9947789610895206, 0.9981215607472925, 0.9982248361559634, 0.9989185644904276, 0.9988924091202211, 0.9961722034278768, 0.9987447630713198, 0.9951890921598616, 0.997291080809667, 0.9949995305943898, 0.9999183328649482, 0.9989778928680733, 0.9958749560407182, 0.9954680769250563]
# 3d hausdorff95 avg:13.067612065019505, std: 8.70223238793063,[10.465926171775568, 5.1390238125212315, 18.728706937897716, 6.457707471638086, 7.496643527580033, 8.282360125875623, 5.3895934456652, 4.553125458699337, 16.213959221401602, 13.545020339775382, 7.6918015837947, 51.386865067486745, 24.025727245347316, 5.453056498081323, 12.288153894263926, 22.67746283799066, 12.576440406179787, 10.18166579096413, 7.160141713157642, 26.190248064858093, 13.381232515731192, 12.937473081789797, 22.283238114521797, 8.948266871824455, 6.48802757965247, 9.224297032866998, 14.393042342616859, 7.610472557360715, 5.87971346538435, 7.851341694936604, 22.88030882775185, 10.363210416854914, 5.72947803924137, 13.62088410808772, 4.583196469129706, 11.642279245045229, 14.528363058570637, 10.58328372196981, 20.233670686161407, 13.590793467804254, 29.1167293834935, 7.066774435069398]

# Loading checkpoint: saved/models/brats_seg_AsynDGANv2_exp43/1013_164547/checkpoint-epoch33.pth ...
# Save test results at saved/test_results/brats_seg_AsynDGANv2_exp43/20201013234614
# 3d dice avg:0.822008552073455, std: 0.08234581723182913,[0.9046000901616598, 0.9295335631451458, 0.8233751529756727, 0.8186224298484057, 0.8731867826547293, 0.8701157379726999, 0.8398542946744637, 0.7604580437768474, 0.8979189327495259, 0.7636795566247204, 0.6660364661246189, 0.8643518427200242, 0.8670973477265702, 0.8724761592854973, 0.7587775683020495, 0.6498424749481867, 0.8509722226692001, 0.8785487408588396, 0.8121059775699088, 0.841332425293732, 0.8082211570760526, 0.8614353888232935, 0.6124999992282005, 0.8276445385786775, 0.8243551727382071, 0.9192340485222286, 0.9142136713921309, 0.8739771149580421, 0.7733415895023589, 0.922408704849498, 0.8828890231827551, 0.6939293585468556, 0.6790532766292189, 0.7604571113164635, 0.8329173525583708, 0.9311475960177907, 0.8725869204518407, 0.7981081018361644, 0.7544694032291426, 0.9358425306607389, 0.6689908679703926, 0.8337504489341886]
# 3d sensitivity avg:0.8440439985817618, std: 0.13335063472508288,[0.9136124097403138, 0.9229454455264038, 0.7121670117632263, 0.9914147952496803, 0.8335747443370214, 0.8287514918029355, 0.9356667379732978, 0.9675293420711615, 0.8609221171654158, 0.6420503045622177, 0.5081904151306299, 0.8497336514265172, 0.9136135812449474, 0.7938122217513902, 0.6660352937462513, 0.981034044963572, 0.982047341903635, 0.9034424705820459, 0.9164283737662577, 0.875462333488633, 0.9367420700819158, 0.9525298166342668, 0.6380844863346373, 0.9344809739747634, 0.9260148685588738, 0.9327965465465465, 0.86350555422594, 0.8209330183342761, 0.8807395574890392, 0.9555589522153652, 0.9529298940495662, 0.541189635878454, 0.6312962209635865, 0.8764621683186603, 0.7350794848020447, 0.9487621578893102, 0.9861013453335208, 0.7531870287086193, 0.7815746219592373, 0.943704737090454, 0.5167450058754407, 0.942995666973922]
# 3d specificity avg:0.994010137579427, std: 0.005381550599453826,[0.998310550561647, 0.998004396419755, 0.9991827729703093, 0.9778975379804122, 0.9977276037339072, 0.9979264499603586, 0.9900891674337832, 0.9869718185260529, 0.9970462534158093, 0.9983929864468207, 0.9998320820526821, 0.9987511325856954, 0.995653795554601, 0.9989534401527165, 0.9982704998075622, 0.9865308467074234, 0.9867556568890965, 0.9957171825899245, 0.9956953904964484, 0.9944429358542005, 0.9855771235644031, 0.9893841738549845, 0.9937493161530093, 0.9929385881907645, 0.9904974828295585, 0.9945349673845904, 0.9990506885488846, 0.9991613851102439, 0.9896976295618168, 0.9969241293664303, 0.9938473342933962, 0.9997776457835567, 0.9956412929428738, 0.986295997401805, 0.9987914744650344, 0.996368409129656, 0.9885244331499017, 0.9985762827351868, 0.9839803015899509, 0.9965494900740944, 0.9998481748179685, 0.9865569572486165]
# 3d hausdorff95 avg:21.291969374370716, std: 11.678730122638658,[13.388551747487027, 12.186877383322752, 15.496522625833885, 27.65429264597642, 13.403308132309526, 15.686735335112358, 24.15240971275646, 61.40453391819523, 10.757750675429275, 15.816676248602816, 21.968279657034568, 9.11349664474265, 26.981434643289017, 10.918508396693468, 17.517295309917, 33.90887131035311, 16.42111921182438, 22.9963559636308, 27.794418985170186, 30.687518577001953, 25.07126171533968, 20.209026800680466, 55.655025217391575, 15.508588752040882, 18.807107119927135, 11.644060682064302, 9.234977524815411, 14.499848770432836, 50.925991652652485, 10.426728720888118, 10.729045373715108, 21.700578303602, 25.115147341569077, 22.926242291438967, 16.777878998647367, 11.738803767183054, 25.95602330247131, 21.05664036727468, 31.29190069371352, 9.489414829450418, 17.01867787665752, 20.22478649693129]


